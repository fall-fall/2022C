# 问题二：玻璃文物分类、亚类划分及可靠性分析 - 最终技术实现文档

### **摘要**

本报告旨在为论文撰写者提供一份关于问题二解决方案的详尽技术备忘录。报告遵循一个三模块的综合分析流程。**模块一**，我们通过探索性数据分析（EDA）形成假设，继而构建并评估了线性和非线性两种支持向量机（SVM）模型，并利用权重分析与SHAP框架深度剖析了高钾与铅钡玻璃的分类规律。**模块二**，我们基于类内方差的原则科学地筛选了用于聚类的化学特征，通过层次聚类方法并结合定量指标确定了最佳亚类数量，最终利用PCA和热力图对亚类进行了可视化“画像”。**模块三**，我们设计并执行了严格的合理性与敏感性分析，通过SVM权重稳定性检验和针对聚类的自助法（Bootstrap）与调整兰德指数（ARI）评估，全面验证了本研究结论的科学性与稳健性。

---

### **模块一：高钾玻璃与铅钡玻璃的分类规律分析**

#### **1.1 探索性数据分析 (EDA)**

* **目的与方法选择理由**
  在进行任何复杂的建模之前，首要任务是通过探索性数据分析（EDA）对数据建立直观且深刻的认知。我们采用描述性统计和并列箱线图，因为它们是最高效、最直观的两种方法，能够快速揭示不同类别数据在数值特征上的分布差异，为后续的建模方向和假设形成提供科学依据。
* **图表介绍与分析：`EDA_并列箱线图.png`**

  * **图片用途说明**：此图旨在直观对比高钾玻璃与铅钡玻璃在全部14种化学成分含量上的分布差异。
  * **图像内容解读**：图中，Y轴为化学成分，X轴为含量百分比。对于每一种成分，都并排展示了两个箱体，分别代表高钾玻璃（浅蓝色）和铅钡玻璃（浅绿色）的含量分布情况（包括中位数、四分位距、异常值等）。
  * **分析与结论**：该图提供了极强的视觉证据。我们可以清晰地看到，在 `氧化铅(PbO)`和 `氧化钡(BaO)`两种成分上，铅钡玻璃的含量分布远高于高钾玻璃；而在 `氧化钾(K2O)`上则呈现完全相反的模式。两个类别在这些关键成分上的箱体几乎没有重叠，这表明这些成分具有极强的区分潜力。基于此，我们形成核心假设：**PbO、BaO与K2O是区分两类玻璃的最关键指标**。

#### **1.2 双模型建立与性能评估**

* **模型选择理由与算法介绍**
  * **线性支持向量机 (Linear SVM)**
    * **选择理由**：为直接、清晰地回答“分类规律是什么”，我们首选线性SVM。其模型形式简单，结果是一个线性的决策超平面，其权重系数 `coef_`能够直观地、定量地反映每个特征对于分类决策的贡献方向与大小，是“白箱”模型中的经典代表。
    * **算法原理**：线性SVM的目标是在N维特征空间中，寻找一个(N-1)维的最优决策超平面。该超平面的“最优”体现在它不仅能将两类样本点分开，还能使得离它最近的样本点（即“支持向量”）到它的几何间隔最大化，从而获得最好的泛化能力。
  * **RBF核支持向量机 (RBF SVM)**
    * **选择理由**：为探索数据的可分性上限，并验证规律在更复杂模型下的表现，我们选择性能强大的RBF核SVM。它能构建非线性决策边界，更好地拟合化学成分间可能存在的复杂关系，其极高的准确率可以佐证我们找到的分类规律是真实且稳健的。
    * **算法原理**：当数据线性不可分时，RBF核SVM通过“核技巧”将原始特征空间映射到一个更高维甚至无限维的希尔伯特空间。在这个新空间中，数据变得线性可分，SVM便可以构建一个线性的超平面。当这个超平面映射回原始空间时，就形成了一条复杂的、非线性的决策边界。
  * **性能评估方法：10折交叉验证**
    * **选择理由**：对于小样本数据集（本题共67个样本），一次性的训练集/测试集划分会带来很大的随机误差。10折交叉验证通过将数据轮流分割为10份进行训练和测试，让每个样本都有机会进入测试集，最终取10次结果的平均值。这是一种更稳定、更可靠的性能评估方法，能有效避免偶然性，是小样本建模的黄金标准。
  * **结果解读**：交叉验证结果显示，线性SVM的平均准确率为**95.71%**，RBF核SVM的平均准确率高达**97.14%**。两者均表现出极高的分类性能，证明仅凭化学成分数据区分两类玻璃是完全可行的。

#### **1.3 分类规律的双重解释**

* **图表介绍与分析：`线性SVM特征权重.png`**

  * **图片用途说明**：此图用于直观展示线性SVM模型学习到的各特征权重，从而解释其分类规律。
  * **图像内容解读**：图中，Y轴为最重要的部分特征，X轴为权重系数值。正向权重（蓝色）将预测推向“高钾玻璃”，负向权重（红色）将预测推向“铅钡玻璃”。
  * **分析与结论**：如图所示，`氧化钾(K2O)`和 `二氧化硅(SiO2)`获得了最大的正权重，而 `氧化铅(PbO)`和 `氧化钡(BaO)`获得了最大的负权重。这一结果与EDA的发现完全一致，并从数学上量化了“拔河模型”：当一个样本输入时，模型就像进行一场拔河比赛，`K2O`含量高等特征会向“高钾”一侧拉，`PbO`含量高等特征会向“铅钡”一侧拉，最终权重与含量的乘积总和决定了胜负。
* **解释工具：SHAP (SHapley Additive exPlanations)**

  * **选择理由**：为解释高性能但“黑箱”的RBF核SVM，我们采用当前最前沿的可解释人工智能（XAI）框架——SHAP。它基于博弈论中的夏普利值，能够公平、准确地将模型的每一次预测结果归因到每个输入特征上，实现对复杂模型的深度洞察。
  * **算法原理**：SHAP将每个特征视为一个“玩家”，一次预测视为一场“合作游戏”的最终收益。它通过计算一个特征在所有可能的特征组合（盟友）中其边际贡献的平均值，来得到该特征对本次预测的贡献大小，即“SHAP值”。
* **图表介绍与分析：`SHAP摘要图.png`**

  * **图片用途说明**：此图是SHAP分析的核心，用于展示全局特征重要性，以及特征值对模型输出影响的方向和模式。
  * **图像内容解读**：图中，Y轴按重要性高低排列特征。每个点代表一个样本的一个特征。X轴是SHAP值，正值推高预测（推向高钾），负值推低预测（推向铅钡）。点的颜色代表该特征原始值的大小（红色为高，蓝色为低）。
  * **分析与结论**：该图再次确认 `PbO`和 `K2O`是最重要的特征。并且它提供了更丰富的细节：高含量的 `PbO`（红点）总是对应着强烈的负向SHAP值；而高含量的 `K2O`（红点）则总是对应着强烈的正向SHAP值。这个清晰的模式，为我们“此消彼长”的规律提供了最坚实的证据。

---

### **模块二：各类别内部的亚类划分**

#### **2.1 基于方差的特征选择**

* **方法选择理由**：亚类划分的目标是寻找**同一个类别内部的差异**。一个特征如果在类别内部的值都差不多（方差小），那它对区分亚类就毫无帮助。因此，选择**类内方差最大**的特征，是找到区分亚类潜在指标的最直接、最有效的统计学方法。
* **图表介绍与分析：`..._特征选择箱线图.png`**
  * **图片用途说明**：此图用于对筛选出的高方差候选特征进行可视化，以验证其数据分布是否适合聚类。
  * **图像内容解读**：图中，Y轴为筛选出的8个特征，X轴为含量。箱体展示了每个特征的分布情况。
  * **分析与结论**：从图中可以看出，我们为高钾和铅钡玻璃筛选出的特征，其箱体普遍较宽或存在较多的离群点，说明其数据分布离散，不集中于某个单一数值，具备将样本区分为不同群组的潜力，从而证明了特征选择的有效性。

#### **2.2 最佳亚类数量(K)的确定**

* **方法选择理由与算法介绍**

  * **层次聚类 (Hierarchical Clustering)**
    * **选择理由**：在不知道确切亚类数量（K值）的情况下，层次聚类是一种理想的探索性方法。它不需要预设K值，而是会构建一个完整的、嵌套的聚类树结构。
    * **算法原理**：它首先将每个样本视为一个独立的簇，然后迭代地将距离最近的两个簇合并，直到所有样本都合并成一个簇为止。整个过程可以通过树状图（Dendrogram）完美地可视化。
  * **轮廓系数法 (Silhouette Score)**
    * **选择理由**：为弥补单纯观察树状图的主观性，我们引入轮廓系数作为定量评估指标。它能客观地衡量不同K值下聚类结果的“好坏”。
    * **方法原理**：该系数综合考量了每个样本的簇内紧密程度（与同一簇内其他点的平均距离）和簇间分离程度（与最近的其他簇的所有点的平均距离）。分数越高，聚类效果越好。
* **图表介绍与分析：`..._层次聚类树状图.png`**

  * **图片用途说明**：此图用于展示样本的层次化聚合过程，为科学地选择最佳亚类数量K值提供定性依据。
  * **图像内容解读**：纵轴代表簇合并时的距离（差异度），距离越大说明合并的两个簇差异越大。横轴是每个文物样本。
  * **分析与结论**：通过寻找最长的、未被跨越的垂直连线来确定最佳切割点，这是从数据自身结构出发确定K值的科学方法。
* **图表介绍与分析：`..._最佳K值选择.png`**

  * **图片用途说明**：此图通过绘制不同K值对应的轮廓系数，为选择最佳K值提供定量依据。
  * **图像内容解读**：X轴为亚类数量K，Y轴为轮廓系数值。
  * **分析与结论**：图中显示，高钾玻璃的轮廓系数在**K=5**时达到峰值；铅钡玻璃在**K=2**时达到峰值。这为我们最终确定亚类数量提供了决定性的数学证据。

#### **2.3 最终聚类与“画像”**

* **图表介绍与分析：`..._亚类PCA图.png`**

  * **图片用途说明**：此图利用PCA降维，将高维的聚类结果投影到二维平面上，以直观地检验亚类划分的有效性。
  * **图像内容解读**：图中每个点是一个样本，颜色代表其所属的亚类。
  * **分析与结论**：从图中可以看到，不同颜色的点形成了相对独立的群组，尤其是在铅钡玻璃（K=2）中，两个亚类区分明显。这证明我们的聚类算法确实找到了数据中客观存在的结构。
* **图表介绍与分析：`..._亚类热力图_带编号.png`**

  * **图片用途说明**：这是**解读亚类内在特征**的核心工具。它通过颜色展示了按亚类排好序的每个样本的化学成分谱。
  * **图像内容解读**：图中，行是按亚类分组的文物样本（已标出编号），列是筛选出的化学成分。颜色越亮代表相对含量越高。红线（或绿线）是亚类之间的分割线。
  * **分析与结论**：通过观察每个亚类区域内部的“垂直颜色条带”，我们可以为每个亚类进行“画像”。例如，铅钡玻璃的两个亚类，一个可能呈现“高PbO、高BaO、低SiO2”的模式，另一个则相反，据此可将其命名为“高铅钡助熔剂型”和“高硅基质型”。同理，对高钾玻璃的5个亚类也可以进行类似的定性描述和命名。

---

### **模块三：可靠性与敏感性分析**

#### **3.1 分类模型的可靠性**

* **方法选择理由**：为证明我们得到的“分类规律”不是由偶然的数据划分导致的，我们需要检验其在不同数据子集上的稳定性。我们通过在K折交叉验证的每一次折叠中，重新训练模型并提取其权重，来直接评估规律本身的稳健性。
* **图表介绍与分析：`SVM权重稳定性分析.png`**

  * **图片用途说明**：此图通过箱线图展示了关键特征的SVM权重在10次不同数据子集训练中的分布情况。
  * **图像内容解读**：X轴是几个关键特征，Y轴是权重系数值。每个箱体都展示了该特征10次权重的分布（中位数、波动范围等）。
  * **分析与结论**：图中显示，`PbO`和 `BaO`的权重在10次实验中始终为显著的负值，`K2O`和 `SiO2`则始终为显著的正值，且每个特征的箱体都很短，说明其权重值波动极小。**这强有力地证明了我们提炼出的分类规律是高度稳健和可信的。**

#### **3.2 亚类划分的敏感性**

* **方法选择理由与算法介绍**：

  * **自助法 (Bootstrap) + 调整兰德指数 (ARI)**
    * **选择理由**：这是评估聚类稳定性最经典、最强大的方法。它通过模拟上百次“重新采样”的过程，来检验聚类结构是否是数据的内在本质，而非随机伪影。
    * **算法原理**：我们从原始数据中有放回地随机抽样，构建B个（例如100个）自助样本集。在每个样本集上重新运行层次聚类，并使用ARI来衡量该次聚类结果与原始完整数据集聚类结果的一致性。ARI是一个取值[-1, 1]的指标，1代表完全一致，0代表随机水平。
* **图表介绍与分析：`层次聚类灵敏度分析_ARI箱线图.png`**

  * **图片用途说明**：此图通过箱线图展示了100次自助抽样聚类得到的ARI分数的分布，用以评估亚类划分结果的稳定性。
  * **图像内容解读**：X轴是玻璃类别，Y轴是ARI分数。箱体展示了ARI分数的集中趋势和离散程度。
  * **分析与结论**：

    * **高钾玻璃**：其ARI分数的中位数高达**0.8204**，且箱体紧凑，说明其划分为5个亚类的结构**非常稳健**，对数据扰动不敏感，是高度可信的发现。
    * **铅钡玻璃**：其ARI分数的中位数仅为**0.3007**，说明其划分为2个亚类的结构**具有一定的敏感性**，两个亚类间的界限比较模糊。这个结论应被视为一种探索性的划分，它揭示了铅钡玻璃内部存在的两种主要趋势，但这两个趋势之间可能存在大量的过渡样本。

    ### **您的提议：“划分成一类是不是更加合理呢？”**

    **是的，这不仅合理，而且是基于您当前的灵敏度分析结果，最科学、最严谨的结论。**

    在数据分析和科学研究中，当我们试图寻找某种结构（例如，多个亚类）时，如果证据不足或结果不稳定，那么我们应该接受“ **零假设（Null Hypothesis）** ”——即这种结构不存在。在这里，“零假设”就是铅钡玻璃内部不存在显著的、可重复的亚类结构，它本身就是一个单一的、完整的类别。

    ### **如何解释与之前“K=2”结论的矛盾？**

    这是一个非常好的问题，也是您在论文中需要清晰论述的地方。这并不矛盾，而是体现了分析的层层深入：


    1. **静态分析的发现** ：我们之前使用的**树状图**和 **轮廓系数法** ，是对**当前这份完整、静态的数据集**寻找“最优”的分割方式。它们给出的结论是：“如果**强制**要将这份数据分成几个簇，那么分成两簇（K=2）是数学上的最优解”。这揭示了数据中可能存在 **微弱的、趋势性的差异** 。
    2. **动态分析的证伪** ：但是， **灵敏度分析** （自助法+ARI）则是在一个更严格的条件下对这个“最优解”进行压力测试。它回答的问题是：“这个K=2的结构是数据的本质属性，还是仅仅是当前这份样本的偶然现象？” **0.3007**这个极低的ARI分数给出了明确的答案：这个结构是 **脆弱的、偶然的** ，一旦数据稍有变动（重采样），这个结构就基本消失了。

    **结论就是** ：铅钡玻璃内部可能存在一些微弱的成分差异趋势，但这种趋势 **不足以形成稳定、可信、可重复的亚类** 。

    ### **论文中的最终表述建议**

    将这个“否定性”发现转化为一个强有力的论点，是展现您团队分析深度的绝佳机会。

    您可以这样在论文中进行论述：

    > “对于铅钡玻璃的亚类划分，我们首先通过层次聚类的树状图和轮廓系数法进行了探索。轮廓系数在K=2时取得最高分，初步表明数据可能存在两个潜在的亚类。
    >
    > 然而，为了检验该二分类结构的稳健性，我们进一步实施了基于100次自助抽样的灵敏度分析。结果显示，该划分的平均调整兰德指数（ARI）仅为0.3007，远低于高钾玻璃划分的稳定性（平均ARI为0.8204）。
    >
    > **这个较低的ARI分数强有力地证明，铅钡玻璃的二分类结构对样本扰动高度敏感，不具备统计学上的稳健性。** 因此，我们最终判定，**铅钡玻璃在本数据集中应被视为一个内部化学成分较为统一的整体类别，不进行亚*类划分。** 这一结论也反映了古代铅钡玻璃工艺可能具有较高的一致性。”
    >

    这样一来，您不仅得出了结论，还清晰地展示了您的论证过程、对模型结果的批判性思维以及最终做出科学决策的能力。这远比给出一个不稳定的“双亚类”结论要严谨和有力得多。
